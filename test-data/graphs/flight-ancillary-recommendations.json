{
  "tests": [
    {
      "input": {
        "customerProfile": {
          "id": "cust-12345",
          "loyaltyTier": "gold",
          "travelFrequency": "frequent",
          "preferredLanguage": "en",
          "preferredCurrency": "USD"
        },
        "route": {
          "origin": "JFK",
          "destination": "international",
          "flightDurationMinutes": 480,
          "hasAirportLounge": true,
          "departureTime": "2025-04-15T08:30:00Z",
          "returnTime": "2025-04-22T15:45:00Z"
        },
        "travelPurpose": "business",
        "tripDetails": {
          "passengers": 1,
          "cabinClass": "economy",
          "dateFlexibility": "fixed"
        },
        "previousPurchases": [
          {
            "bookingId": "bkg-9876",
            "productType": "seat",
            "purchaseDate": "2024-12-10T14:22:00Z",
            "productDetails": {
              "seatType": "extra_legroom",
              "amount": 35
            }
          },
          {
            "bookingId": "bkg-8765",
            "productType": "wifi",
            "purchaseDate": "2024-11-05T09:15:00Z",
            "productDetails": {
              "packageType": "full_flight",
              "amount": 19.99
            }
          }
        ]
      },
      "output": {
        "recommendations": [
          {
            "priority": 5,
            "productType": "lounge"
          },
          {
            "priority": 4,
            "productType": "priority_boarding"
          },
          {
            "priority": 3,
            "productType": "wifi"
          },
          {
            "priority": 4,
            "productType": "lounge"
          },
          {
            "priority": 3,
            "productType": "travel_insurance"
          },
          {
            "priority": 2,
            "productType": "premium_meal"
          },
          {
            "priority": 4,
            "productType": "fast_track_security"
          }
        ]
      }
    }
  ],
  "nodes": [
    {
      "type": "inputNode",
      "content": {
        "schema": ""
      },
      "id": "ip1",
      "name": "request",
      "position": {
        "x": 110,
        "y": 292.5
      }
    },
    {
      "type": "decisionTableNode",
      "content": {
        "hitPolicy": "first",
        "rules": [
          {
            "_id": "r1-1",
            "i1-1": ">= 240",
            "o1-1": "'long'"
          },
          {
            "_id": "r1-2",
            "i1-1": ">= 120 and < 240",
            "o1-1": "'medium'"
          },
          {
            "_id": "r1-3",
            "i1-1": "< 120",
            "o1-1": "'short'"
          }
        ],
        "inputs": [
          {
            "id": "i1-1",
            "name": "Flight Duration Minutes",
            "field": "route.flightDurationMinutes"
          }
        ],
        "outputs": [
          {
            "id": "o1-1",
            "name": "Duration Category",
            "field": "flightDurationCategory"
          }
        ],
        "passThrough": true,
        "inputField": null,
        "outputPath": null,
        "executionMode": "single"
      },
      "id": "dt1",
      "name": "categorize_flight_duration",
      "position": {
        "x": 430,
        "y": 292.5
      }
    },
    {
      "type": "expressionNode",
      "content": {
        "expressions": [
          {
            "id": "e1-1",
            "key": "isPremiumCustomer",
            "value": "customerProfile.loyaltyTier == 'gold' or customerProfile.loyaltyTier == 'platinum'"
          },
          {
            "id": "e1-2",
            "key": "hasBoughtBaggage",
            "value": "some(previousPurchases ?? [], #.productType == 'baggage')"
          },
          {
            "id": "e1-3",
            "key": "hasBoughtMeals",
            "value": "some(previousPurchases ?? [], #.productType == 'meal')"
          },
          {
            "id": "e1-4",
            "key": "hasBoughtSeats",
            "value": "some(previousPurchases ?? [], #.productType == 'seat')"
          },
          {
            "id": "e1-5",
            "key": "hasBoughtLounge",
            "value": "some(previousPurchases ?? [], #.productType == 'lounge')"
          }
        ],
        "passThrough": true,
        "inputField": null,
        "outputPath": null,
        "executionMode": "single"
      },
      "id": "ex1",
      "name": "calculate_customer_attributes",
      "position": {
        "x": 750,
        "y": 292.5
      }
    },
    {
      "type": "decisionTableNode",
      "content": {
        "hitPolicy": "collect",
        "rules": [
          {
            "_id": "r2-1",
            "i2-1": "'business'",
            "i2-2": "'long'",
            "i2-3": "isPremiumCustomer",
            "o2-1": "'lounge'",
            "o2-2": "5"
          },
          {
            "_id": "r2-2",
            "i2-1": "'business'",
            "i2-2": "'medium', 'long'",
            "i2-3": "",
            "o2-1": "'priority_boarding'",
            "o2-2": "4"
          },
          {
            "_id": "r2-3",
            "i2-1": "'business'",
            "i2-2": "",
            "i2-3": "",
            "o2-1": "'wifi'",
            "o2-2": "3"
          },
          {
            "_id": "r2-4",
            "i2-1": "'leisure'",
            "i2-2": "'long'",
            "i2-3": "",
            "o2-1": "'extra_baggage'",
            "o2-2": "5"
          },
          {
            "_id": "r2-5",
            "i2-1": "'leisure'",
            "i2-2": "'medium', 'long'",
            "i2-3": "!hasBoughtMeals",
            "o2-1": "'meal'",
            "o2-2": "4"
          },
          {
            "_id": "r2-6",
            "i2-1": "'leisure'",
            "i2-2": "",
            "i2-3": "!hasBoughtSeats",
            "o2-1": "'seat_selection'",
            "o2-2": "3"
          },
          {
            "_id": "r2-7",
            "i2-1": "'family'",
            "i2-2": "'medium', 'long'",
            "i2-3": "",
            "o2-1": "'family_seating'",
            "o2-2": "5"
          },
          {
            "_id": "r2-8",
            "i2-1": "'family'",
            "i2-2": "",
            "i2-3": "!hasBoughtBaggage",
            "o2-1": "'extra_baggage'",
            "o2-2": "4"
          },
          {
            "_id": "r2-9",
            "i2-1": "'family'",
            "i2-2": "'long'",
            "i2-3": "",
            "o2-1": "'entertainment_package'",
            "o2-2": "3"
          }
        ],
        "inputs": [
          {
            "id": "i2-1",
            "name": "Travel Purpose",
            "field": "travelPurpose"
          },
          {
            "id": "i2-2",
            "name": "Flight Duration",
            "field": "flightDurationCategory"
          },
          {
            "id": "i2-3",
            "name": "Customer Attributes",
            "field": ""
          }
        ],
        "outputs": [
          {
            "id": "o2-1",
            "name": "Product",
            "field": "productType"
          },
          {
            "id": "o2-2",
            "name": "Priority",
            "field": "priority"
          }
        ],
        "passThrough": true,
        "inputField": null,
        "outputPath": "recommendations.base",
        "executionMode": "single",
        "passThorough": false
      },
      "id": "dt2",
      "name": "base_recommendations",
      "position": {
        "x": 1070,
        "y": 292.5
      }
    },
    {
      "type": "decisionTableNode",
      "content": {
        "hitPolicy": "collect",
        "rules": [
          {
            "_id": "r3-1",
            "i3-1": "route.hasAirportLounge and !hasBoughtLounge",
            "i3-2": "isPremiumCustomer",
            "o3-1": "'lounge'",
            "o3-2": "4"
          },
          {
            "_id": "r3-2",
            "i3-1": "route.destination == 'international'",
            "i3-2": "",
            "o3-1": "'travel_insurance'",
            "o3-2": "3"
          },
          {
            "_id": "r3-3",
            "i3-1": "flightDurationCategory == 'long' and !hasBoughtMeals",
            "i3-2": "",
            "o3-1": "'premium_meal'",
            "o3-2": "2"
          },
          {
            "_id": "r3-4",
            "i3-1": "customerProfile.travelFrequency == 'frequent' and travelPurpose == 'business'",
            "i3-2": "",
            "o3-1": "'fast_track_security'",
            "o3-2": "4"
          },
          {
            "_id": "r3-5",
            "i3-1": "route.destination == 'beach' or route.destination == 'resort'",
            "i3-2": "travelPurpose == 'leisure'",
            "o3-1": "'excursion_package'",
            "o3-2": "3"
          }
        ],
        "inputs": [
          {
            "id": "i3-1",
            "name": "Route Attributes",
            "field": ""
          },
          {
            "id": "i3-2",
            "name": "Customer Context",
            "field": ""
          }
        ],
        "outputs": [
          {
            "id": "o3-1",
            "name": "Additional Product",
            "field": "productType"
          },
          {
            "id": "o3-2",
            "name": "Priority",
            "field": "priority"
          }
        ],
        "passThrough": true,
        "inputField": null,
        "outputPath": "recommendations.additional",
        "executionMode": "single",
        "passThorough": false
      },
      "id": "dt3",
      "name": "additional_recommendations",
      "position": {
        "x": 1390,
        "y": 292.5
      }
    },
    {
      "type": "expressionNode",
      "content": {
        "expressions": [
          {
            "id": "0a0fbafe-0a16-445a-99f8-c8b4341ef370",
            "key": "recommendations",
            "value": "flatten(values(recommendations))"
          }
        ],
        "passThrough": false,
        "inputField": null,
        "outputPath": null,
        "executionMode": "single"
      },
      "id": "8cb0ce16-c426-4988-b39f-d122499bc1fd",
      "name": "join_recommendations",
      "position": {
        "x": 1710,
        "y": 292.5
      }
    }
  ],
  "edges": [
    {
      "id": "ed1",
      "sourceId": "ip1",
      "targetId": "dt1",
      "type": "edge"
    },
    {
      "id": "ed2",
      "sourceId": "dt1",
      "targetId": "ex1",
      "type": "edge"
    },
    {
      "id": "ed3",
      "sourceId": "ex1",
      "targetId": "dt2",
      "type": "edge"
    },
    {
      "id": "ed4",
      "sourceId": "dt2",
      "targetId": "dt3",
      "type": "edge"
    },
    {
      "id": "d0ef3f95-c4cf-4311-8ae0-6d2fc9771730",
      "sourceId": "dt3",
      "type": "edge",
      "targetId": "8cb0ce16-c426-4988-b39f-d122499bc1fd"
    }
  ]
}