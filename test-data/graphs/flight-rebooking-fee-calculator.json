{
  "tests": [
    {
      "input": {
        "bookingId": "BK-12345678",
        "fareClass": "Economy",
        "originalDepartureDate": "2025-05-15T10:30:00Z",
        "newDepartureDate": "2025-05-20T14:15:00Z",
        "daysToDeparture": 12,
        "passengerDetails": {
          "firstName": "Jane",
          "lastName": "Smith",
          "loyaltyTier": "Silver",
          "loyaltyNumber": "LM789012"
        },
        "changeFrequency": 2,
        "loyaltyTier": "Silver"
      },
      "output": {
        "modificationFee": {
          "allowed": true,
          "description": "Standard modification fee",
          "finalFee": 188
        }
      }
    }
  ],
  "nodes": [
    {
      "type": "inputNode",
      "content": {
        "schema": ""
      },
      "id": "ip1",
      "name": "bookingModificationRequest",
      "position": {
        "x": 110,
        "y": 114
      }
    },
    {
      "type": "decisionTableNode",
      "content": {
        "hitPolicy": "first",
        "rules": [
          {
            "_id": "r1-1",
            "i1-1": "'First'",
            "i1-2": "> 14",
            "o1-1": "0",
            "o1-2": "'No fee for First Class with >14 days to departure'"
          },
          {
            "_id": "r1-2",
            "i1-1": "'First'",
            "i1-2": "<= 14",
            "o1-1": "50",
            "o1-2": "'Minimal fee for First Class with ≤14 days to departure'"
          },
          {
            "_id": "r1-3",
            "i1-1": "'Business'",
            "i1-2": "> 21",
            "o1-1": "75",
            "o1-2": "'Standard fee for Business Class with >21 days to departure'"
          },
          {
            "_id": "r1-4",
            "i1-1": "'Business'",
            "i1-2": "> 7 and <= 21",
            "o1-1": "100",
            "o1-2": "'Medium fee for Business Class with 7-21 days to departure'"
          },
          {
            "_id": "r1-5",
            "i1-1": "'Business'",
            "i1-2": "<= 7",
            "o1-1": "150",
            "o1-2": "'Higher fee for Business Class with ≤7 days to departure'"
          },
          {
            "_id": "r1-6",
            "i1-1": "'Economy'",
            "i1-2": "> 30",
            "o1-1": "100",
            "o1-2": "'Standard fee for Economy with >30 days to departure'"
          },
          {
            "_id": "r1-7",
            "i1-1": "'Economy'",
            "i1-2": "> 14 and <= 30",
            "o1-1": "150",
            "o1-2": "'Medium fee for Economy with 14-30 days to departure'"
          },
          {
            "_id": "r1-8",
            "i1-1": "'Economy'",
            "i1-2": "> 3 and <= 14",
            "o1-1": "200",
            "o1-2": "'High fee for Economy with 3-14 days to departure'"
          },
          {
            "_id": "r1-9",
            "i1-1": "'Economy'",
            "i1-2": "<= 3",
            "o1-1": "250",
            "o1-2": "'Very high fee for Economy with ≤3 days to departure'"
          },
          {
            "_id": "r1-10",
            "i1-1": "",
            "i1-2": "",
            "o1-1": "300",
            "o1-2": "'Default fee for any other fare class'"
          }
        ],
        "inputs": [
          {
            "id": "i1-1",
            "name": "Fare Class",
            "field": "fareClass"
          },
          {
            "id": "i1-2",
            "name": "Days to Departure",
            "field": "daysToDeparture"
          }
        ],
        "outputs": [
          {
            "id": "o1-1",
            "name": "Base Fee",
            "field": "modificationFee.baseFee"
          },
          {
            "id": "o1-2",
            "name": "Base Fee Reason",
            "field": "modificationFee.baseFeeReason"
          }
        ],
        "passThrough": true,
        "inputField": null,
        "outputPath": null,
        "executionMode": "single"
      },
      "id": "dt1",
      "name": "baseFeeCalculation",
      "position": {
        "x": 430,
        "y": 114
      }
    },
    {
      "type": "decisionTableNode",
      "content": {
        "hitPolicy": "first",
        "rules": [
          {
            "_id": "r2-1",
            "i2-1": "<= 1",
            "o2-1": "1",
            "o2-2": "'No additional charge for first change'"
          },
          {
            "_id": "r2-2",
            "i2-1": "> 1 and <= 3",
            "o2-1": "1.25",
            "o2-2": "'25% surcharge for 2-3 changes'"
          },
          {
            "_id": "r2-3",
            "i2-1": "> 3",
            "o2-1": "1.5",
            "o2-2": "'50% surcharge for frequent changes'"
          },
          {
            "_id": "r2-4",
            "i2-1": "",
            "o2-1": "1",
            "o2-2": "'Default multiplier'"
          }
        ],
        "inputs": [
          {
            "id": "i2-1",
            "name": "Change Frequency",
            "field": "changeFrequency"
          }
        ],
        "outputs": [
          {
            "id": "o2-1",
            "name": "Frequency Multiplier",
            "field": "modificationFee.frequencyMultiplier"
          },
          {
            "id": "o2-2",
            "name": "Frequency Reason",
            "field": "modificationFee.frequencyReason"
          }
        ],
        "passThrough": true,
        "inputField": null,
        "outputPath": null,
        "executionMode": "single"
      },
      "id": "dt2",
      "name": "frequencyMultiplier",
      "position": {
        "x": 750,
        "y": 114
      }
    },
    {
      "type": "decisionTableNode",
      "content": {
        "hitPolicy": "first",
        "rules": [
          {
            "_id": "r3-1",
            "i3-1": "'Platinum'",
            "o3-1": "0",
            "o3-2": "'Platinum members receive fee waiver'"
          },
          {
            "_id": "r3-2",
            "i3-1": "'Gold'",
            "o3-1": "0.5",
            "o3-2": "'Gold members receive 50% discount'"
          },
          {
            "_id": "r3-3",
            "i3-1": "'Silver'",
            "o3-1": "0.75",
            "o3-2": "'Silver members receive 25% discount'"
          },
          {
            "_id": "r3-4",
            "i3-1": "",
            "o3-1": "1",
            "o3-2": "'No loyalty discount applied'"
          }
        ],
        "inputs": [
          {
            "id": "i3-1",
            "name": "Loyalty Tier",
            "field": "loyaltyTier"
          }
        ],
        "outputs": [
          {
            "id": "o3-1",
            "name": "Loyalty Factor",
            "field": "modificationFee.loyaltyFactor"
          },
          {
            "id": "o3-2",
            "name": "Loyalty Reason",
            "field": "modificationFee.loyaltyReason"
          }
        ],
        "passThrough": true,
        "inputField": null,
        "outputPath": null,
        "executionMode": "single"
      },
      "id": "dt3",
      "name": "loyaltyFactor",
      "position": {
        "x": 1070,
        "y": 114
      }
    },
    {
      "type": "expressionNode",
      "content": {
        "expressions": [
          {
            "id": "e1-1",
            "key": "adjustedFee",
            "value": "round(modificationFee.baseFee * modificationFee.frequencyMultiplier * modificationFee.loyaltyFactor)"
          }
        ],
        "passThrough": true,
        "inputField": null,
        "outputPath": null,
        "executionMode": "single"
      },
      "id": "ex1",
      "name": "calculateAdjustedFee",
      "position": {
        "x": 1390,
        "y": 114
      }
    },
    {
      "type": "decisionTableNode",
      "content": {
        "hitPolicy": "first",
        "rules": [
          {
            "_id": "r4-1",
            "i4-1": "loyaltyTier == 'Platinum' and daysToDeparture > 1",
            "o4-1": "0",
            "o4-2": "'Waived - Platinum member benefit'",
            "o4-3": "true"
          },
          {
            "_id": "r4-2",
            "i4-1": "adjustedFee == 0",
            "o4-1": "0",
            "o4-2": "'No fee applicable'",
            "o4-3": "true"
          },
          {
            "_id": "r4-3",
            "i4-1": "fareClass == 'First' and daysToDeparture <= 1",
            "o4-1": "100",
            "o4-2": "'Minimum fee for same-day changes'",
            "o4-3": "true"
          },
          {
            "_id": "r4-4",
            "i4-1": "daysToDeparture <= 1",
            "o4-1": "max([200, adjustedFee])",
            "o4-2": "'Same-day change fee applied'",
            "o4-3": "true"
          },
          {
            "_id": "r4-5",
            "i4-1": "",
            "o4-1": "adjustedFee",
            "o4-2": "'Standard modification fee'",
            "o4-3": "true"
          }
        ],
        "inputs": [
          {
            "id": "i4-1",
            "name": "Condition"
          }
        ],
        "outputs": [
          {
            "id": "o4-1",
            "name": "Final Fee",
            "field": "modificationFee.finalFee"
          },
          {
            "id": "o4-2",
            "name": "Fee Description",
            "field": "modificationFee.description"
          },
          {
            "id": "o4-3",
            "name": "Modification Allowed",
            "field": "modificationFee.allowed"
          }
        ],
        "inputField": null,
        "outputPath": null,
        "executionMode": "single",
        "passThorough": false
      },
      "id": "dt4",
      "name": "finalFeeAssessment",
      "position": {
        "x": 1710,
        "y": 115
      }
    }
  ],
  "edges": [
    {
      "id": "ed1",
      "sourceId": "ip1",
      "targetId": "dt1",
      "type": "edge"
    },
    {
      "id": "ed2",
      "sourceId": "dt1",
      "targetId": "dt2",
      "type": "edge"
    },
    {
      "id": "ed3",
      "sourceId": "dt2",
      "targetId": "dt3",
      "type": "edge"
    },
    {
      "id": "ed4",
      "sourceId": "dt3",
      "targetId": "ex1",
      "type": "edge"
    },
    {
      "id": "ed5",
      "sourceId": "ex1",
      "targetId": "dt4",
      "type": "edge"
    }
  ]
}