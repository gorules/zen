{
  "tests": [
    {
      "input": {
        "vitals": {
          "temperature": 38.7,
          "heartRate": 115,
          "respiratoryRate": 24,
          "systolicBP": 165,
          "oxygenSaturation": 94
        },
        "symptoms": [
          "moderate pain",
          "fever",
          "dizziness"
        ],
        "chiefComplaint": "fracture"
      },
      "output": {
        "highestFlag": "orange",
        "maxWaitTimeMinutes": 10,
        "priorityLevel": "Level 2 - Very Urgent"
      }
    }
  ],
  "nodes": [
    {
      "type": "inputNode",
      "content": {
        "schema": ""
      },
      "id": "input",
      "name": "request",
      "position": {
        "x": 110,
        "y": 114
      }
    },
    {
      "type": "decisionTableNode",
      "content": {
        "hitPolicy": "first",
        "rules": [
          {
            "_id": "vs1",
            "i1": "> 39.5",
            "i2": ")40..160(",
            "i3": ")8..30(",
            "i4": ")80..200(",
            "i5": "< 90",
            "o1": "30",
            "o2": "'red'"
          },
          {
            "_id": "vs2",
            "i1": "> 38.5",
            "i2": ")50..150(",
            "i3": ")10..25(",
            "i4": ")90..180(",
            "i5": "< 93",
            "o1": "20",
            "o2": "'orange'"
          },
          {
            "_id": "vs3",
            "i1": "> 38.0",
            "i2": ")55..140(",
            "i3": ")12..22(",
            "i4": ")100..170(",
            "i5": "< 95",
            "o1": "10",
            "o2": "'yellow'"
          },
          {
            "_id": "vs4",
            "i1": "",
            "i2": "",
            "i3": "",
            "i4": "",
            "i5": "",
            "o1": "0",
            "o2": "'green'"
          }
        ],
        "inputs": [
          {
            "id": "i1",
            "name": "Temperature (Â°C)",
            "field": "vitals.temperature"
          },
          {
            "id": "i2",
            "name": "Heart Rate (bpm)",
            "field": "vitals.heartRate"
          },
          {
            "id": "i3",
            "name": "Respiratory Rate (bpm)",
            "field": "vitals.respiratoryRate"
          },
          {
            "id": "i4",
            "name": "Systolic BP (mmHg)",
            "field": "vitals.systolicBP"
          },
          {
            "id": "i5",
            "name": "O2 Saturation (%)",
            "field": "vitals.oxygenSaturation"
          }
        ],
        "outputs": [
          {
            "id": "o1",
            "name": "Score",
            "field": "scores.vitalScore"
          },
          {
            "id": "o2",
            "name": "Flag",
            "field": "flags.vitalFlag"
          }
        ],
        "passThrough": true,
        "inputField": null,
        "outputPath": null,
        "executionMode": "single",
        "passThorough": false
      },
      "id": "vitalSigns",
      "name": "vital_signs_assessment",
      "position": {
        "x": 430,
        "y": 114
      }
    },
    {
      "type": "decisionTableNode",
      "content": {
        "hitPolicy": "first",
        "rules": [
          {
            "_id": "sym1",
            "i1": "some(symptoms, # in [\"severe pain\", \"chest pain\", \"difficulty breathing\", \"unconscious\", \"unresponsive\", \"active bleeding\"])",
            "o1": "30",
            "o2": "'red'"
          },
          {
            "_id": "sym2",
            "i1": "some(symptoms, # in [\"moderate pain\", \"vomiting\", \"dehydration\", \"fever\", \"dizziness\", \"head injury\"])",
            "o1": "20",
            "o2": "'orange'"
          },
          {
            "_id": "sym3",
            "i1": "some(symptoms, # in [\"mild pain\", \"nausea\", \"minor injury\", \"rash\", \"cough\"])",
            "o1": "10",
            "o2": "'yellow'"
          },
          {
            "_id": "sym4",
            "i1": "",
            "o1": "0",
            "o2": "'green'"
          }
        ],
        "inputs": [
          {
            "id": "i1",
            "name": "Expression"
          }
        ],
        "outputs": [
          {
            "id": "o1",
            "name": "Score",
            "field": "scores.symptomScore"
          },
          {
            "id": "o2",
            "name": "Flag",
            "field": "flags.symptomFlag"
          }
        ],
        "passThrough": true,
        "inputField": null,
        "outputPath": null,
        "executionMode": "single",
        "passThorough": false
      },
      "id": "symptoms",
      "name": "symptom_assessment",
      "position": {
        "x": 750,
        "y": 114
      }
    },
    {
      "type": "decisionTableNode",
      "content": {
        "hitPolicy": "first",
        "rules": [
          {
            "_id": "cc1",
            "i1": "\"stroke\", \"heart attack\", \"cardiac arrest\", \"trauma\", \"anaphylaxis\", \"overdose\", \"seizure\"",
            "o1": "40",
            "o2": "'red'"
          },
          {
            "_id": "cc2",
            "i1": "\"fracture\", \"deep cut\", \"burn\", \"allergic reaction\", \"infection\", \"pregnancy complication\"",
            "o1": "20",
            "o2": "'orange'"
          },
          {
            "_id": "cc3",
            "i1": "\"sprain\", \"minor cut\", \"cold\", \"flu\", \"ear pain\", \"medication refill\"",
            "o1": "10",
            "o2": "'yellow'"
          },
          {
            "_id": "cc4",
            "i1": "",
            "o1": "0",
            "o2": "'green'"
          }
        ],
        "inputs": [
          {
            "id": "i1",
            "name": "Chief Complaint",
            "field": "chiefComplaint"
          }
        ],
        "outputs": [
          {
            "id": "o1",
            "name": "Score",
            "field": "scores.complaintScore"
          },
          {
            "id": "o2",
            "name": "Flag",
            "field": "flags.complaintFlag"
          }
        ],
        "passThrough": true,
        "inputField": null,
        "outputPath": null,
        "executionMode": "single",
        "passThorough": false
      },
      "id": "chiefComplaint",
      "name": "chief_complaint_assessment",
      "position": {
        "x": 1070,
        "y": 114
      }
    },
    {
      "type": "decisionTableNode",
      "content": {
        "hitPolicy": "first",
        "rules": [
          {
            "_id": "cp1",
            "i1": "contains($, 'red')",
            "i2": ">= 60",
            "o1": "'Level 1 - Immediate'",
            "o2": "0",
            "o3": "'red'"
          },
          {
            "_id": "cp2",
            "i1": "contains($, 'red')",
            "i2": ">= 40",
            "o1": "'Level 2 - Very Urgent'",
            "o2": "10",
            "o3": "'red'"
          },
          {
            "_id": "cp3",
            "i1": "contains($, 'orange')",
            "i2": ">= 40",
            "o1": "'Level 2 - Very Urgent'",
            "o2": "10",
            "o3": "'orange'"
          },
          {
            "_id": "cp4",
            "i1": "",
            "i2": ">= 40",
            "o1": "'Level 2 - Very Urgent'",
            "o2": "10",
            "o3": "'orange'"
          },
          {
            "_id": "cp5",
            "i1": "contains($, 'orange')",
            "i2": ">= 20",
            "o1": "'Level 3 - Urgent'",
            "o2": "30",
            "o3": "'orange'"
          },
          {
            "_id": "cp6",
            "i1": "",
            "i2": ">= 20",
            "o1": "'Level 3 - Urgent'",
            "o2": "30",
            "o3": "'yellow'"
          },
          {
            "_id": "cp7",
            "i1": "contains($, 'yellow')",
            "i2": ">= 10",
            "o1": "'Level 4 - Standard'",
            "o2": "60",
            "o3": "'yellow'"
          },
          {
            "_id": "cp8",
            "i1": "",
            "i2": ">= 10",
            "o1": "'Level 4 - Standard'",
            "o2": "60",
            "o3": "'green'"
          },
          {
            "_id": "cp9",
            "i1": "",
            "i2": "",
            "o1": "'Level 5 - Non-Urgent'",
            "o2": "120",
            "o3": "'green'"
          }
        ],
        "inputs": [
          {
            "id": "i1",
            "name": "All flags",
            "field": "values(flags)"
          },
          {
            "id": "i2",
            "name": "Total Score",
            "field": "scores.vitalScore + scores.symptomScore + scores.complaintScore"
          }
        ],
        "outputs": [
          {
            "id": "o1",
            "name": "Priority Level",
            "field": "priorityLevel"
          },
          {
            "id": "o2",
            "name": "Max Wait Time (minutes)",
            "field": "maxWaitTimeMinutes"
          },
          {
            "id": "o3",
            "name": "Highest Flag",
            "field": "highestFlag"
          }
        ],
        "passThrough": false,
        "inputField": null,
        "outputPath": null,
        "executionMode": "single"
      },
      "id": "calculatePriority",
      "name": "calculate_priority_level",
      "position": {
        "x": 1390,
        "y": 114
      }
    }
  ],
  "edges": [
    {
      "id": "edge1",
      "sourceId": "input",
      "targetId": "vitalSigns",
      "type": "edge"
    },
    {
      "id": "edge2",
      "sourceId": "vitalSigns",
      "targetId": "symptoms",
      "type": "edge"
    },
    {
      "id": "edge3",
      "sourceId": "symptoms",
      "targetId": "chiefComplaint",
      "type": "edge"
    },
    {
      "id": "edge4",
      "sourceId": "chiefComplaint",
      "targetId": "calculatePriority",
      "type": "edge"
    }
  ]
}